{% extends 'base.html' %}

{% block title %}Consolidador T25{% endblock %}
{% block page_title %}Consolidador T25 con GoAnywhere{% endblock %}

{% block content %}

<div class="max-w-7xl mx-auto">
    
    <!-- Breadcrumb -->
    <nav class="flex mb-6" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-2">
            <li class="inline-flex items-center">
                <a href="{{ url_for('dashboard') }}" class="text-neutral-500 hover:text-positiva-600 inline-flex items-center text-sm transition-smooth">
                    <i data-feather="home" class="w-4 h-4 mr-2"></i>
                    Dashboard
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <i data-feather="chevron-right" class="w-4 h-4 text-neutral-400 mx-2"></i>
                    <span class="text-sm text-neutral-700 font-medium">Consolidador T25</span>
                </div>
            </li>
        </ol>
    </nav>
    
    <!-- Header -->
    <div class="card-gradient rounded-2xl border border-neutral-100 p-6 sm:p-8 mb-6 shadow-card">
        <div class="flex items-start space-x-4">
            <div class="w-16 h-16 bg-gradient-to-br from-indigo-100 to-indigo-50 rounded-2xl flex items-center justify-center flex-shrink-0">
                <i data-feather="server" class="w-8 h-8 text-indigo-600"></i>
            </div>
            <div class="flex-1">
                <h2 class="text-2xl sm:text-3xl font-bold text-neutral-900 mb-3">Consolidador T25 con GoAnywhere</h2>
                <p class="text-neutral-600 leading-relaxed">
                    Conéctate al servidor <strong>GoAnywhere SFTP</strong>, navega por los directorios, 
                    descarga archivos Excel T25 y procésalos automáticamente.
                </p>
            </div>
        </div>
    </div>
    
    <!-- Estado de Conexión -->
    <div id="status-card" class="card-gradient rounded-2xl border border-neutral-100 p-6 mb-6 shadow-card hidden">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div id="status-icon" class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                    <i data-feather="wifi" class="w-6 h-6 text-green-600"></i>
                </div>
                <div>
                    <p class="text-sm font-semibold text-neutral-900">Estado de Conexión</p>
                    <p id="status-text" class="text-xs text-neutral-600">Conectado a GoAnywhere</p>
                </div>
            </div>
            <button onclick="desconectar()" class="px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-smooth text-sm font-medium">
                <i data-feather="log-out" class="w-4 h-4 inline mr-1"></i>
                Desconectar
            </button>
        </div>
    </div>
    
    <!-- Formulario de Conexión -->
    <div id="connection-form" class="card-gradient rounded-2xl border border-neutral-100 p-6 sm:p-8 mb-6 shadow-card">
        <h3 class="text-xl font-bold text-neutral-900 mb-6">Conectar a GoAnywhere SFTP</h3>
        
        <div class="max-w-md">
            <div class="mb-6">
                <label class="block text-sm font-semibold text-neutral-900 mb-2">
                    <i data-feather="server" class="w-4 h-4 inline mr-2 text-indigo-600"></i>
                    Servidor
                </label>
                <input type="text" 
                       value="mft.positiva.gov.co:2243" 
                       disabled
                       class="w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-neutral-500 cursor-not-allowed">
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-semibold text-neutral-900 mb-2">
                    <i data-feather="user" class="w-4 h-4 inline mr-2 text-indigo-600"></i>
                    Usuario
                </label>
                <input type="text" 
                       value="G_medica" 
                       disabled
                       class="w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-neutral-500 cursor-not-allowed">
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-semibold text-neutral-900 mb-2">
                    <i data-feather="lock" class="w-4 h-4 inline mr-2 text-indigo-600"></i>
                    Contraseña
                </label>
                <input type="password" 
                       id="password-input"
                       placeholder="Ingresa la contraseña"
                       class="w-full px-4 py-3 border border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-smooth">
            </div>
            
            <button onclick="conectar()" 
                    id="connect-btn"
                    class="w-full px-6 py-3 bg-gradient-to-r from-indigo-500 to-indigo-600 text-white rounded-xl hover:from-indigo-600 hover:to-indigo-700 transition-smooth font-semibold inline-flex items-center justify-center shadow-md">
                <i data-feather="log-in" class="w-5 h-5 mr-2"></i>
                Conectar al Servidor
            </button>
        </div>
    </div>
    
    <!-- Información -->
    <div class="card-gradient rounded-2xl border border-neutral-100 p-6 sm:p-8 shadow-card">
        <div class="flex items-center space-x-3 mb-6">
            <div class="w-10 h-10 bg-indigo-50 rounded-xl flex items-center justify-center">
                <i data-feather="info" class="w-5 h-5 text-indigo-600"></i>
            </div>
            <h3 class="text-xl font-bold text-neutral-900">¿Cómo funciona?</h3>
        </div>
        
        <div class="grid sm:grid-cols-2 gap-6">
            <div class="bg-neutral-50 rounded-xl p-5 border border-neutral-100">
                <h4 class="font-semibold text-neutral-900 mb-4 flex items-center">
                    <i data-feather="check-circle" class="w-4 h-4 mr-2 text-indigo-600"></i>
                    Pasos del Proceso
                </h4>
                <ol class="space-y-2 text-sm text-neutral-600">
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600 font-bold">1.</span>
                        <span>Conecta al servidor GoAnywhere con tus credenciales</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600 font-bold">2.</span>
                        <span>Navega por los directorios usando el explorador</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600 font-bold">3.</span>
                        <span>Descarga el archivo Excel T25 que necesites</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600 font-bold">4.</span>
                        <span>Procesa automáticamente y descarga el consolidado</span>
                    </li>
                </ol>
            </div>
            
            <div class="bg-neutral-50 rounded-xl p-5 border border-neutral-100">
                <h4 class="font-semibold text-neutral-900 mb-4 flex items-center">
                    <i data-feather="file-text" class="w-4 h-4 mr-2 text-indigo-600"></i>
                    Formatos Soportados
                </h4>
                <ul class="space-y-2 text-sm text-neutral-600">
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600">•</span>
                        <span><strong>.xlsx</strong> - Excel moderno</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600">•</span>
                        <span><strong>.xls</strong> - Excel antiguo</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600">•</span>
                        <span><strong>.xlsb</strong> - Excel binario</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <span class="text-indigo-600">•</span>
                        <span>Tamaño máximo: <strong>10 MB</strong></span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
</div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/modules/consolidador_t25.js') }}"></script>
{% endblock %}